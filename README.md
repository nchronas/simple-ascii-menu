# simple-ascii-menu

This time I will work the opposite way. I will take a simple code that I have used and written hundreds of times, compare with the chatGPT generated code and compare it. Than use my code, input that to chatGPT and ask it to generate the same code for different languages and see how it will work.

## Design

I will make a small ascii menu that is comma delimited. This is something that you will find in a lot of embedded projects and it usually as a debugging menu through UART. For this example there is no need to use UART so I will focus on the full sentences. 

An example structure of an ASCII comma seperated, newline delimited menu is "COMMAND,data1,data2\n". First comes the command string that tells the device what to, next with each comma we have additional parameters to the command and lastly Newline signifies the end of the command. It's not necessary to have parameters for all commands.

It is also very usual to have a help command that prints all available commands, with a description of it's function and it's parameters.

For this example I'm going to have a command  turns on, off or blinks a led, a command that returns the status of a button (pressed/not pressed), and a help command. This simulates a typical embedded device.

Keep in mind that the seperated values can also be with another character besides comma, like space, tab etc.

Again this is not itented as production code and not an indiaction of code quality

## Implementation of the menu

The following explaination was generated by chatGPT

### Summary

**Summary:**

This C code is a command-line interface program that processes user commands. It includes standard C libraries and defines constants. It provides functions to print help menus, simulate button presses, and control an LED. 

The `process_buffer` function tokenizes user input into a command and its parameters. The `main` function continuously prompts for user input, processes commands, and executes corresponding functions. It handles commands like "help," "led," and "button," displaying appropriate messages or simulating actions.

*Note:*
- The help menu description is not fully implemented.
- Random button status is simulated for testing purposes.
- Basic error checking is in place.
- The program runs until manually exited.

### Detailed explaination

This C code appears to be a simple command-line interface program that reads commands from the user and executes corresponding functions based on the entered commands. Let's break down the code step by step:

#### 1. Includes and Definitions:
- The code includes several standard C libraries like `stdbool.h`, `stdio.h`, `stdint.h`, `string.h`, and `stdlib.h`.
- It defines some constants:
  - `MAX_COMMAND_CHARACTERS`: Maximum number of characters for a command (set to 6).
  - `MAX_COMMAND_PARAMETERS`: Maximum number of command parameters (set to 5).
  - `FIELD_SEPERATOR`: The separator used to split commands and parameters (a comma in this case).
  - `MAX_INPUT_CHARACTERS`: Maximum number of characters for user input (set to 100).

#### 2. Function Definitions:
- `print_help_menu()`: Prints a description of the available commands (not fully implemented).
- `print_button_command()`: Simulates whether a button is pressed or not and prints its status.
- `print_led_command(char *parameters[], __uint8_t args)`: Handles LED-related commands, such as turning the LED on, off, or blinking it with a specified frequency.

#### 3. `process_buffer` Function:
- This function processes the user input, splitting it into a command and its parameters.
- It takes the following parameters:
  - `command`: A pointer to store the parsed command string.
  - `parameters`: An array of pointers to store parsed command parameters.
  - `args`: A pointer to store the number of parsed arguments.
  - `buffer`: The input buffer containing the user's command.
- It uses `strtok_r` to tokenize the input string based on the defined `FIELD_SEPERATOR` (`,`).
- It counts the number of arguments and prints the parsed command and argument count.

#### 4. `main` Function:
- The program's entry point.
- Declares variables to store the command, parameters, and argument count.
- Uses a `while` loop to repeatedly prompt the user for input and process commands.
- Reads user input into the `buffer` array using `scanf`.
- Calls `process_buffer` to parse the input into `cmd`, `par`, and `args`.
- Based on the parsed command, it performs the following actions:
  - If the command is "help," it calls `print_help_menu`.
  - If the command is "led," it calls `print_led_command`.
  - If the command is "button," it calls `print_button_command`.
  - Otherwise, it displays "Command not found."

**Note:**
- The code does not fully implement the help menu description.
- It generates a random button status in `print_button_command` to simulate button presses.
- The code does basic error checking, such as checking for incorrect parameters or missing arguments.
- The program continues to prompt for commands until the user exits manually (no exit condition in the code).


## During "development"

The C++ program run with the first try. Since C and C++ are close that wasn't a suprise but the same happened with the python

The rust and the go needed a small fix in the way that they handled the number of arguments, the error was solved when I inputed the code to the chatGPT and I asked for it to fix it. Thank you AI overlord :)

I asked chatGPT to make the C code into a class and that improved the readability. It also worked immidietely without errors.

## Improving the code

I asked chatGPT on how it will improvement my C code. It's suggestions were on point and that was what I would suggest if I saw the simple code in a merge request. I'm not sure if this is a generic answer for all improvements or is it tailored for my code. 

**Improvements:**

1. **Error Handling:**
   - Implement extensive error handling to check for potential errors such as invalid user input or system errors.

2. **Function Declarations:**
   - Declare functions before `main()` or provide function prototypes in a header file for better organization.

3. **Modularization:**
   - Break down the code into smaller, more focused functions. Have separate functions for parsing input, processing commands, and executing actions.

4. **Comments and Documentation:**
   - Add comments to explain the purpose and logic of functions, especially complex ones, for better code understanding.

5. **Use `stdbool.h` Properly:**
   - Since `stdbool.h` is included, use `bool` instead of `__uint8_t` for better readability.

6. **Replace Magic Numbers:**
   - Replace magic numbers with named constants or variables to improve code readability and understandability.

7. **Avoid Global Variables:**
   - Minimize the use of global variables. If possible, pass variables as arguments to functions to improve code maintainability.

8. **Input Sanitization:**
   - Use safer input methods like `fgets()` instead of `scanf()` to prevent buffer overflow and improve program robustness.

9. **Descriptive Naming:**
   - Use descriptive names for variables and functions to enhance code readability and comprehension.

10. **Handle Command Not Found:**
    - Provide a message for commands that are not recognized to give user feedback.

11. **Exit Condition:**
    - Add an exit condition for the program to allow the user to quit gracefully.

12. **Testing and Validation:**
    - Include more extensive testing for all possible input scenarios to ensure program correctness.

13. **Memory Management:**
    - Ensure that memory allocation and deallocation is handled correctly, especially when working with strings.

14. **Random Function Use:**
    - If simulating button presses, consider using a more sophisticated random number generator or use a predefined pattern for testing.

15. **Function Return Types:**
    - Ensure that functions return appropriate values. For example, `process_buffer` could return a boolean to indicate success or failure.

16. **Include Guards (Header Files):**
    - If this code is part of a larger project, consider using include guards in header files to prevent multiple inclusions.

17. **Consistent Naming Conventions:**
    - Adopt a consistent naming convention for variables, functions, and macros to maintain code consistency.

18. **Unit Testing:**
    - Implement unit tests to verify the correctness of individual functions and improve code reliability.


## Takeaways

It took me much more time to shape up the 2 C codes that it took the chatGPT to generate the code for different languages. It was effective and worked almost out of the box.

When I tried to edit the question about the explanation so it will format it for markdown it removed the next steps with the code generation and unfortenetely I lost them. I will keep that in mind for future projects.

The explaination it provided was pretty good. I also asked for a summary and that reduce the information significantly. This will greatly reduce the time for documentation, something that most developers, including me don't enjoy doing.

The improvements were on point and that was what I would suggest if I saw the simple code in a merge request.